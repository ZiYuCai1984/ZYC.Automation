<menuItems:ContextMenuItemBase x:Class="ZYC.Automation.Workspace.BuildIn.MoveWorkSpaceTabItemHeaderContextMenuItem"
                               x:ClassModifier="internal"
                               xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                               xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                               xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                               xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                               xmlns:menuItems="clr-namespace:ZYC.Automation.Core.MenuItems;assembly=ZYC.Automation.Core"
                               xmlns:converters="clr-namespace:ZYC.Automation.Core.Converters;assembly=ZYC.Automation.Core"
                               xmlns:localizations="clr-namespace:ZYC.Automation.Core.Localizations;assembly=ZYC.Automation.Core"
                               mc:Ignorable="d"
                               d:DesignHeight="450" d:DesignWidth="800"
                               IsEnabled="{Binding SubItems,Converter={converters:CollectionNotEmptyToBoolConverter}}"
                               Header="{localizations:L Move To}"
                               Tag="{Binding PlacementTarget.DataContext, RelativeSource={RelativeSource AncestorType=ContextMenu}}"
                               ItemsSource="{Binding SubItems}">
    <menuItems:ContextMenuItemBase.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/ZYC.Automation;component/Styles/MainMenu.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </menuItems:ContextMenuItemBase.Resources>

    <MenuItem.ItemContainerStyle>
        <Style BasedOn="{StaticResource MahApps.Styles.MenuItem}"
               TargetType="MenuItem">
            <EventSetter Event="MouseEnter" Handler="OnMenuItemMouseEnter" />
            <EventSetter Event="MouseLeave" Handler="OnMenuItemMouseLeave" />
            <Setter Property="ItemsSource" Value="{Binding SubItems}" />
            <Setter Property="Command"
                    Value="{Binding Command}" />
            <Setter Property="Header" Value="{Binding Title,Converter={converters:DigitsToEmojiConverter}}" />
            <Setter Property="VirtualizingStackPanel.IsVirtualizing" Value="False" />
            <!--!WARNING There is a suspected virtualization problem here. If it is set in the DataTemplate, it will not load normally.-->
            <!--!WARNING Explicitly specify the Binding Path !! -->
            <!--<Setter Property="Icon"
                    Value="{Binding Path=(mainMenu:IMainMenuItem.Icon),Converter={converters:PackIconMaterialConverter}}" />-->
            <Style.Triggers>
                <Trigger Property="Role" Value="TopLevelHeader">
                    <Setter Property="Padding" Value="7 5 8 6" />
                    <Setter Property="Template"
                            Value="{DynamicResource {ComponentResourceKey ResourceId=TopLevelHeaderTemplateKey, TypeInTargetAssembly={x:Type MenuItem}}}" />
                </Trigger>
                <Trigger Property="Role" Value="TopLevelItem">
                    <Setter Property="Padding" Value="7 5 8 6" />
                    <Setter Property="Template"
                            Value="{DynamicResource {ComponentResourceKey ResourceId=TopLevelItemTemplateKey, TypeInTargetAssembly={x:Type MenuItem}}}" />
                </Trigger>
                <Trigger Property="Role" Value="SubmenuHeader">
                    <Setter Property="Padding" Value="2 6 2 6" />
                    <Setter Property="Template"
                            Value="{DynamicResource {ComponentResourceKey ResourceId=SubmenuHeaderTemplateKey, TypeInTargetAssembly={x:Type MenuItem}}}" />
                </Trigger>
                <Trigger Property="Role" Value="SubmenuItem">
                    <Setter Property="Padding" Value="2 6 2 6" />
                    <Setter Property="Template"
                            Value="{DynamicResource {ComponentResourceKey ResourceId=SubmenuItemTemplateKey, TypeInTargetAssembly={x:Type MenuItem}}}" />
                </Trigger>
                <DataTrigger Binding="{Binding}" Value="{x:Null}">
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="MenuItem">
                                <Separator />
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </MenuItem.ItemContainerStyle>
</menuItems:ContextMenuItemBase>